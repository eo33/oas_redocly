import { useThemeHooks } from '@redocly/theme/core/hooks';

export function useProductPicker() {
  const { useCurrentProduct, useProducts, usePreloadHistory, useTelemetry } = useThemeHooks();
  const currentProduct = useCurrentProduct();
  const products = useProducts();
  const telemetry = useTelemetry();
  const history = usePreloadHistory();

  function setProduct(product: typeof currentProduct) {
    if (!product) return;
    telemetry.send('product_picked', { product: product.slug });
    history.push(product.link);
  }
  return {
    currentProduct,
    products,
    setProduct,
  };
}
