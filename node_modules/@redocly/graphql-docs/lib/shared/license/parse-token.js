var d=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var m=Object.prototype.hasOwnProperty;var _=(n,e)=>{for(var t in e)d(n,t,{get:e[t],enumerable:!0})},x=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of v(e))!m.call(n,o)&&o!==t&&d(n,o,{get:()=>e[o],enumerable:!(i=w(e,o))||i.enumerable});return n};var y=n=>x(d({},"__esModule",{value:!0}),n);var A={};_(A,{parseToken:()=>N});module.exports=y(A);var u=require("./helpers"),s=require("./validate"),E=function(n,e,t,i){function o(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function p(r){try{l(i.next(r))}catch(f){c(f)}}function h(r){try{l(i.throw(r))}catch(f){c(f)}}function l(r){r.done?a(r.value):o(r.value).then(p,h)}l((i=i.apply(n,e||[])).next())})};function D(n){return Date.now()/1e3>n}function N(n){return E(this,void 0,void 0,function*(){if(process.env.NODE_ENV==="development")return{valid:!0,allowed:!0};const e=window.location.hostname;if(!n)return{local:(0,u.isLocalhost)(e)};let t;try{t=yield(0,s.validate)(n)}catch{return{valid:!1,cryptoMissing:!0}}return t.valid=!0,t.expired=t.e?D(t.e):!0,t.allowed=(0,u.isHostAllowed)(e,t.h),t})}0&&(module.exports={parseToken});
