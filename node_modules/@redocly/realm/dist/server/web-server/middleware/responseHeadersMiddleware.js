import{minimatch as l}from"minimatch";import{SERVER_EDITOR_APP_URL as m,withoutPathPrefix as p}from"../../../shared/urls.js";import{removeTrailingSlash as d}from"../../../shared/utils.js";function R(n){return async(e,i)=>{try{await i()}finally{const r=n.getConfig();if(r.responseHeaders){const a=p(new URL(e.req.url).pathname),t=Object.keys(r.responseHeaders);for(const s of t)if(l(a,s))for(const{name:f,value:c}of r.responseHeaders[s])e.header(f,c)}const o=e.req.header("referer");o&&d(o)===m&&e.header("Cross-Origin-Resource-Policy","cross-origin")}}}export{R as responseHeadersMiddleware};
