import{useMemo as p}from"react";import{components as c}from"@redocly-markdoc/components";import{Ast as l}from"@markdoc/markdoc";import{PageNavigation as u}from"@redocly/theme/components/PageNavigation/PageNavigation";import{tags as f,components as g}from"@redocly/theme/markdoc/default";import{Breadcrumbs as d}from"@redocly/theme/components/Breadcrumbs/Breadcrumbs";import{withPathPrefix as _}from"../../../../shared/urls.js";import{getCssPropertyValue as h}from"../../../../shared/utils.js";import{isBrowser as P}from"../../../../shared/jsUtils.js";import*as S from"../../markdown/markdoc/custom-components/index.js";import*as v from"../../markdown/markdoc/nodes/index.js";import O from"../../markdown/markdoc/tags/index.js";import{usePageData as C,useSidebarSiblingsData as A}from"../../../../client/providers/page-data/hooks";import{telemetry as T}from"../../../../client/app/telemetry/index.js";import{OPENAPI_DOCS_TEMPLATE_ID as I,ServerRoutes as y}from"../../../../shared/constants.js";import{getMockServerDocsConfig as D}from"./mock-server-config";function $(o="",t="",e="/"){return o.endsWith(e)&&(o=o.slice(0,-e.length)),t.startsWith(e)&&(t=t.slice(e.length)),!o||!t?o+t:o+e+t}function i(o){return({operationHttpVerb:t,operationPath:e,lang:r,action:n,state:m,serverUrl:s})=>T.send("openapi_docs",{event_type:o,operationHttpVerb:t,operationPath:e,lang:r,action:n,state:m,serverUrl:s})}function R(o){if(o)return Object.entries(o).reduce((t,[e,r])=>(t[e]=l.fromJSON(JSON.stringify(r)),t),{})}function F(o,{markdown:t,baseSlug:e}){return p(()=>{const n=P();return o.options.oAuth2RedirectURI=n?`${window.location.origin}${_(y.REPLAY_OAUTH2_CALLBACK)}`:null,o.options.routingBasePath=e,o.options.mockServer=D(o.options.mockServer,e),o.options.scrollYOffset=n?parseInt(h("--navbar-height"),10):0,o.options.markdocOptions={tags:{...O,...f},nodes:{...v},components:{...S,...g,...c,...globalThis.__LOADER.markdocComponents},...t,partials:R(t?.partials)},o.options.unstable_hooks={...o.options.unstable_hooks,MiddlePanelFooter:()=>{const{templateId:m}=C()||{},{nextPage:s,prevPage:a}=A()||{};return m===I?null:u({nextPage:s,prevPage:a})},MiddlePanelHeader:()=>d({})},o.options.events={codeSamplesLanguageSwitch:i("samples_language_switch"),codeSamplesCopy:i("code_samples_copy"),panelToggle:i("panel_toggle"),targetServerSwitch:i("target_server_switch")},o},[o,t,e])}export{$ as joinWithSeparator,F as usePatchedStore};
