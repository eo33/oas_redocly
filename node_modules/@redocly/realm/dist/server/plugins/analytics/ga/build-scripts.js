import{Minimatch as i}from"minimatch";import g from"react";const l=e=>{const o=[],n=[g.createElement("link",{rel:"preconnect",key:"preconnect-google-gtag",href:"https://www.googletagmanager.com"}),g.createElement("link",{rel:"dns-prefetch",key:"dns-prefetch-google-gtag",href:"https://www.googletagmanager.com"})],r=s(e);return e.head?n.push(...r):o.push(...r),{headComponents:n,postBodyComponents:o}};function s(e){const o=[];typeof e.exclude<"u"&&e.exclude.map(c=>{const a=new i(c).makeRe();a&&o.push(a)});const n=[...Object.entries(e.trackers||{})],r=()=>`
      ${o.length?`window.excludeGtagPaths=[${o.join(",")}];`:""}
      ${e.anonymizeIp===!0?`function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='${e.trackingId}',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);`:""}
      if(${e.respectDNT?'!(navigator.doNotTrack == "1" || window.doNotTrack == "1")':"true"}) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        ${n.map(([c,t])=>{const a=JSON.stringify({optimize_id:t.optimizeId,anonymize_ip:e.anonymizeIp,cookie_expires:e.cookieExpires,send_page_view:!1,groups:c});return`

        gtag('config', '${t.trackingId}', ${a});
        ${t.conversionId?`gtag('config', '${t.conversionId}', ${a});`:""}
        ${t.floodlightId?`gtag('config', '${t.floodlightId}', ${a});`:""}
        `}).join(`
`)}

        
      }
      `;return[g.createElement("script",{key:"gatsby-plugin-google-gtag",async:!0,src:`https://www.googletagmanager.com/gtag/js?id=${e.trackingId}`}),g.createElement("script",{key:"gatsby-plugin-google-gtag-config",dangerouslySetInnerHTML:{__html:r()}})]}export{l as buildScripts};
