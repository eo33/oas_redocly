import{Minimatch as m}from"minimatch";import{isProductionMode as p}from"../../../../shared/env.js";import{buildScripts as a}from"./build-scripts.js";import{resolveBrowserHooksPath as l}from"./resolve-browser-hooks.js";import{Feature as u}from"../../../entitlements/entitlements.types.js";async function P(){return{id:"Amplitude Analytics",requiredEntitlements:[u.Analytics],async processContent(o,{getConfig:n}){const e=(await n())?.analytics?.amplitude;if(!e?.apiKey||!p()&&!e.includeInDevelopment)return;let t=[];typeof e.exclude<"u"&&e.exclude.map(s=>{const d=new m(s);t.push(d.makeRe())});const{headComponents:i,postBodyComponents:r}=a(e,t);o.addSsrComponents(i,"head"),o.addSsrComponents(r,"postBody"),o.addBrowserPlugin(l())}}}export{P as amplitudeAnalyticsPlugin};
