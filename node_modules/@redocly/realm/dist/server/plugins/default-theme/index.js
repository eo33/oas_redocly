import{DEFAULT_SSO_IDP_TITLE as T,DEV_LOGIN_SLUG as p,PUBLIC_RBAC_SCOPE_ITEM as I,REDOCLY_TEAMS_RBAC as L,UI_ACCESSIBLE_CONFIG_PROPS as D}from"../../../shared/constants.js";import{getTemplatePath as g}from"./get-template-path.js";import{resolveLinksFromConfig as l}from"../nav-utils.js";import{resolveLogoConfig as S}from"./resolve-logo.js";import{extractTeamNames as _}from"./extract-team-names.js";import{resolveProductsConfig as b}from"./resolve-products-config.js";import{CONFIG_FILE_NAME as P}from"../../constants.js";async function w(i){return{id:"Default Theme",async processContent(e){const t=C(e),r=Object.keys(e.getConfig()?.ssoDirect||{}).length>0;if(i.devLogin&&r){let s={frontmatter:{},seo:{title:"Login page"},authIdps:t.filter(a=>a.title!=T),rbac:{teams:_(e.getConfig().rbac)}};const o=e.createTemplate("dev-login",g("../../../../dist/client/app/pages/DevLogin/DevLogin.js"));e.addRoute({duplicateInAllLocales:!0,excludeFromSidebar:!0,slug:p,[L]:I,fsPath:p,templateId:o,getStaticData:async(a,n)=>({props:{...s,loginUrls:n.getLoginUrls()}})})}else if(t.length>1){let s={frontmatter:{},seo:{title:"Login page"},authIdps:t};const o=e.createTemplate("login",g("../../../../dist/client/app/pages/Login/Login.js"));e.addRoute({duplicateInAllLocales:!0,excludeFromSidebar:!0,slug:p,[L]:I,fsPath:p,templateId:o,getStaticData:async(a,n)=>({props:{...s,loginUrls:n.getLoginUrls()}})})}e.createTemplate("404",g("../../../../dist/client/app/pages/404/404.js")),e.createTemplate("403",g("../../../../dist/client/app/pages/403/403.js")),e.createTemplate("403OIDC",g("../../../../dist/client/app/pages/403/403OIDC.js"))},async afterRoutesCreated(e,t){const{contentDir:r,outdir:s}=e,o=e.getConfig(),{navbar:a,footer:n,userMenu:d,search:u,breadcrumbs:f,products:h}=o,c=Object.keys(o?.ssoDirect||{}).length>0,m={navFile:P};e.setGlobalData({...v(o),navbar:await l(a,r,e,t,m),footer:await l(n,r,e,t,m),breadcrumbs:{...f,prefixItems:await l(f?.prefixItems||[],r,e,t)},userMenu:{...d,hide:d?.hide??!c,menu:await l(d?.items,r,e,t)},logo:await S(o.logo,r,s,t.fs),auth:{idpsInfo:C(e),devLogin:i.devLogin&&c,loginUrls:e.getLoginUrls()},products:await b(h,e,t),search:{...u,suggestedPages:await l(u?.suggestedPages,r,e,t)},headScriptTags:void 0,linkTags:void 0,postBodyScriptTags:void 0,preBodyScriptTags:void 0})}}}function C(i){const e=i.getConfig().ssoDirect;return Object.entries(e||{}).map(([r,s])=>({idpId:r,type:s.type,title:s.title}))}function v(i){const e={};for(const t of D)i[t]&&(e[t]=i[t]);return e}export{w as defaultThemePlugin,v as pickUiAccessibleConfig};
