import c from"@markdoc/markdoc";import{isTag as f}from"../../../shared/utils.js";import{slugger as p}from"../../utils/index.js";import{getMarkdocOptions as u}from"./markdoc/markdoc-options.js";import{visit as g,getHeadingData as h}from"./markdoc/plugins/utils.js";import{renderMermaid as b}from"./markdoc/plugins/render-mermaid.js";async function D(s,m,n){const d=await u(n),e=[],t=[];p.reset();const a=c.transform(s,{...d,...m});g(a,r=>{if(f(r))switch(r.name){case"Heading":const i=h(r);i&&e.push(i);break;case"Mermaid":t.push({tag:r,source:r.attributes.diagramSource});break}});const o=await b(t.map(r=>r.source));for(let r=0;r<o.length;r++)t[r].tag.attributes.diagramHtml=o[r];return{headings:e,renderableAst:a}}export{D as transformMdAst};
