import*as r from"path";import{existsSync as h}from"fs";import{copyStaticFile as u}from"../../utils/index.js";import{USER_THEME_ALIAS as v}from"../../config/constants.js";import{setMapValue as c}from"../../utils/map.js";const f=/\.(gif|jpe?g|tiff?|png|webp|bmp|eot|otf|woff|woff2|ttf|pdf|svg|mp4|webm)$/i,D=(l,a)=>{const n=r.resolve(a,v),t=new Map;return{name:"esbuild-redocly-custom-assets-resolver",setup:i=>{i.onResolve({filter:f},e=>{const s=r.resolve(e.resolveDir,e.path);if(!h(s))return;const o=e.kind+":"+s;if(t.has(o))return t.get(o);const p=u(e.resolveDir,s,l.outdir);if(e.kind==="url-token")return c(t,o,{external:!0,path:p,watchDirs:[n]});{const m=r.relative(a,s);return c(t,o,{namespace:"assets-ns",path:m,pluginData:{assetPath:p},watchDirs:[n]})}}),i.onLoad({filter:f,namespace:"assets-ns"},({pluginData:e})=>({contents:e.assetPath,loader:"text"}))}}};export{D as AssetsResolver};
