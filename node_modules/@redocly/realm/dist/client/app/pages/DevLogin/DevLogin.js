import t,{useEffect as g,useState as s}from"react";import{useNavigate as h}from"react-router-dom";import{Button as y}from"@redocly/theme/components/Button/Button";import{H3 as S}from"@redocly/theme/components/Typography/H3";import{H4 as v}from"@redocly/theme/components/Typography/H4";import{Admonition as w}from"@redocly/theme/components/Admonition/Admonition";import{telemetry as E}from"@portal/telemetry";import{buildClientLoginUrl as P,getPathnameForLocale as L,withPathPrefix as b}from"../../utils";import{ServerRoutes as k}from"../../../../shared/constants";import{usePageProps as O}from"../../../providers/page-data/hooks";import{Wrapper as T,HeadingSection as C}from"./styled";import{DevLoginForm as R}from"./DevLoginForm";import{useL10nConfig as F}from"../../hooks";async function U(r){try{const{status:o}=await fetch(b(k.AUTHORIZATION),{method:"POST",body:JSON.stringify(r)});return o}catch(o){console.error(o)}}function Z(){const{defaultLocale:r,locales:o,currentLocale:c}=F(),l=h(),[n,d]=s({values:{teams:[]}}),[i,u]=s();g(()=>{const e=new URLSearchParams(window.location.search);u(e.get("redirectTo")||void 0)},[]);const a=O(),m=a?.authIdps,p=(a.rbac?.teams||[]).filter(e=>e!=="*"),f=async()=>{await U(n.values)===200&&(l(i||"/"),window.location.reload())};return t.createElement(T,null,t.createElement(C,null,t.createElement(S,{"data-cy":"login-title"},"Dev-mode login"),t.createElement(w,{type:"warning",name:"This is dev mode login simulator."},"Any email works and password is not checked.")),t.createElement(t.Fragment,null,t.createElement(R,{teams:p,formState:n,setFormState:d,onSubmit:f}),Object.keys(m||{}).length>0&&t.createElement(v,null,"Use SSO:"),Object.values(m||{}).map(e=>t.createElement("div",{key:e.idpId},t.createElement("a",{href:P(e.idpId,e.type,L("",r,c,o),a.loginUrls,i)},t.createElement(y,{fullWidth:!0,size:"large","data-cy":"idp-login",onClick:()=>E.send("login_provider_button_clicked",{provider:e.type})},e.title||e.type))))))}export{Z as default};
