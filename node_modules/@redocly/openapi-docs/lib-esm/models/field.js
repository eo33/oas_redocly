import{REDOCLY_TEAMS_RBAC}from"@redocly/config";import{joinWithSeparator}from"../services";import{extractExtensions,getValueFromMdParsedExtension,mapValues,removePercentChart}from"../utils";import{getSchema}from"./schema";import{getExamples}from"./example";const DEFAULT_SERIALIZATION={path:{style:"simple",explode:!1},query:{style:"form",explode:!0},header:{style:"simple",explode:!1},cookie:{style:"form",explode:!0}};export function getField(e,o,t,i,n,s,l=t){var r,a,d,m,p,c,x;const{resolved:u}=e.deref(o),v=o.kind||"field",E=o.name||u.name,f=u.in,h=!!u.required;let A,g,O=u.schema,R="";if(!O&&u.in&&u.content){R=Object.keys(u.content)[0];const o=u.content[R];O=o&&(null==o?void 0:o.example)?Object.assign(Object.assign({},e.deref(o.schema,s,!0).resolved),{example:u.example||o.example}):o.schema}const F=joinWithSeparator(n.parentFieldFullPath,removePercentChart(E||"")),S=getSchema({parser:e,schemaOrRef:O||{},pointer:t,options:i,baseRefsStack:s,absolutePointer:o.$ref||(null===(r=u.schema)||void 0===r?void 0:r.absolutePointer)||l,deps:Object.assign(Object.assign({},n),{parentFieldFullPath:F,in:f})}),y=void 0===u.description?getValueFromMdParsedExtension(S,"description")||"":getValueFromMdParsedExtension(u,"description"),_=u.example||S.example,C=u.examples||(null===(d=null===(a=u.content)||void 0===a?void 0:a[R])||void 0===d?void 0:d.examples),L=C?mapValues(C,((o,t)=>getExamples({parser:e,infoOrRef:o,mime:t,encoding:u.encoding}))):void 0;R?A=R:u.style?g=u.style:f&&(g=null!==(p=null===(m=DEFAULT_SERIALIZATION[f])||void 0===m?void 0:m.style)&&void 0!==p?p:"form");const P=void 0===u.explode&&f?null===(x=null===(c=DEFAULT_SERIALIZATION[f])||void 0===c?void 0:c.explode)||void 0===x||x:!!u.explode;return{deps:n||{},schema:S,name:E,required:h,description:y,example:_,examples:L,deprecated:void 0===u.deprecated?S.deprecated:u.deprecated,in:f,kind:v,extensions:i.showExtensions?extractExtensions(u,i.showExtensions):void 0,explode:P,style:g,const:(null==S?void 0:S.const)||(null==u?void 0:u.const)||"",serializationMime:A,fieldFullPath:F,[REDOCLY_TEAMS_RBAC]:u[REDOCLY_TEAMS_RBAC]||S[REDOCLY_TEAMS_RBAC]}}
//# sourceMappingURL=field.js.map