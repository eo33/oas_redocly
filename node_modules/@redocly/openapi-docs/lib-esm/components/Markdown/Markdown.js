var __rest=this&&this.__rest||function(r,o){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&o.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var e=0;for(n=Object.getOwnPropertySymbols(r);e<n.length;e++)o.indexOf(n[e])<0&&Object.prototype.propertyIsEnumerable.call(r,n[e])&&(t[n[e]]=r[n[e]])}return t};import{jsx as _jsx,Fragment as _Fragment}from"react/jsx-runtime";import React,{Fragment}from"react";import{parse,transform,renderers,Ast}from"@markdoc/markdoc";import{useAtomValue}from"jotai";import DOMPurify from"dompurify";import{Markdown as MarkdownWrapper,isString}from"@redocly/theme";import{globalOptionsAtom}from"../../jotai/store";const TAGS_NOT_TO_WRAP=["OpenApiResponse","OpenApiRequestBody"];export const Markdown=r=>{var o,t,n,e,i,s,a,l,d,{source:m,ast:u,htmlWrap:p}=r,c=__rest(r,["source","ast","htmlWrap"]);const v=useAtomValue(globalOptionsAtom);if(!m&&!u)return null;const f=(null==v?void 0:v.markdocOptions)&&{tags:null===(o=v.markdocOptions)||void 0===o?void 0:o.tags,nodes:null===(t=v.markdocOptions)||void 0===t?void 0:t.nodes,partials:null===(n=v.markdocOptions)||void 0===n?void 0:n.partials,variables:null===(e=v.markdocOptions)||void 0===e?void 0:e.variables,functions:null===(i=v.markdocOptions)||void 0===i?void 0:i.functions},O=(null==v?void 0:v.markdocOptions)&&{components:null===(s=v.markdocOptions)||void 0===s?void 0:s.components};let y;if(m)if(isString(m)){const r=(null===(a=null==v?void 0:v.unstable_hooks)||void 0===a?void 0:a.sanitize)?null===(d=null===(l=v.unstable_hooks)||void 0===l?void 0:l.sanitize)||void 0===d?void 0:d.call(l,m):(null==v?void 0:v.sanitize)?DOMPurify.sanitize(m):m,o=parse(r);y=transform(o,f)}else{const r=Ast.fromJSON("object"==typeof m.result?JSON.stringify(m.result):m.result);y=(Array.isArray(r),transform(r,f))}else u&&(y=transform(u,f));const _=r=>{const o=renderers.react(r,React,O);return _jsx(MarkdownWrapper,Object.assign({},c,{children:o,as:"div"}))};if(!p)return _(y);const b=r=>{var o;return!1!==(null===(o=r.attributes)||void 0===o?void 0:o.htmlWrap)&&!TAGS_NOT_TO_WRAP.includes(null==r?void 0:r.name)};return y=Array.isArray(y)?y:y.children,_jsx(_Fragment,{children:y.map(((r,o)=>{var t,n,e;return _jsx(Fragment,{children:(n=b(r),e=r,n?p(_(e)):_(e))},(null===(t=null==r?void 0:r.attributes)||void 0===t?void 0:t.id)||o)}))})};
//# sourceMappingURL=Markdown.js.map