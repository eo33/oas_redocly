var __rest=this&&this.__rest||function(e,r){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(o=Object.getOwnPropertySymbols(e);t<o.length;t++)r.indexOf(o[t])<0&&Object.prototype.propertyIsEnumerable.call(e,o[t])&&(a[o[t]]=e[o[t]])}return a};import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from"react/jsx-runtime";import{memo,useCallback}from"react";import styled from"styled-components";import{useAtomValue}from"jotai";import{TypeName}from"../common";import{Schema}from"./Schema";import{ObjectSchema}from"./ObjectSchema";import{humanizeConstraints}from"../../utils";import{SubSchema}from"./SubSchema";import{globalOptionsAtom}from"../../jotai/store";import{getExpandByDefault}from"./helpers";function ArraySchemaComponent(e){var r,a,{schema:o,schema:{minItems:t,maxItems:l,items:n},fieldParentsName:s}=e,i=__rest(e,["schema","schema","fieldParentsName"]);const{schemasExpansionLevel:m}=useAtomValue(globalOptionsAtom),c=void 0===t&&void 0===l?"":`(${humanizeConstraints(o)})`;let p=s?[...s.slice(0,-1),s[s.length-1]+"[]"]:s;const d=useCallback((e=>i.skipReadOnly||i.skipWriteOnly?null==e?void 0:e.filter((e=>!(i.skipReadOnly&&e.schema.readOnly||i.skipWriteOnly&&e.schema.writeOnly))):e),[i.skipReadOnly,i.skipWriteOnly]);if(null==o?void 0:o.fields)return _jsx(ObjectSchema,Object.assign({},i,{level:(null==i?void 0:i.level)||1,schema:o,fieldParentsName:p}));if(o.displayType&&!n&&!c.length)return _jsx("div",{children:_jsx(TypeName,{children:o.displayType})});const y=d(null==n?void 0:n.fields),h=d(null===(a=null===(r=null==n?void 0:n.oneOf)||void 0===r?void 0:r[0])||void 0===a?void 0:a.fields),u=(null==y?void 0:y.length)||(null==h?void 0:h.length),b=1===i.level,f=getExpandByDefault({level:i.level,required:i.required,schemasExpansionLevel:m});return _jsx(SubSchema,Object.assign({},i,{propertyLength:u,isArray:!0,expandable:!b,expandByDefault:f,operationPointer:o.operationPointer,children:_jsxs(_Fragment,{children:[b&&_jsx(ArrayLabel,{children:_jsx(LabelValue,{children:"Array ["})}),_jsx(Schema,Object.assign({},i,{schema:n,fieldParentsName:p,expandable:!1})),b&&_jsx(ArrayClosingLabel,{className:"array-closing-label",children:_jsx(LabelValue,{children:"]"})})]})}))}const ArrayLabel=styled.span`
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  margin-top: var(--spacing-xs);

  :after {
    content: '';
    flex: auto;
    border-top: 1px solid var(--border-color-primary);
  }
`,LabelValue=styled.span`
  padding: 0 var(--spacing-xs);
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color-secondary);
  background-color: var(--bg-color);
  font-size: var(--font-size-sm);
  line-height: var(--line-height-sm);
  color: var(--tag-basic-content-color);
`;export const ArrayClosingLabel=styled(ArrayLabel)`
  margin-top: 0;
  margin-left: auto;

  :after {
    content: none;
  }

  :before {
    content: '';
    flex: auto;
    border-top: 1px solid var(--border-color-primary);
  }
`;export const ArraySchema=memo(ArraySchemaComponent);
//# sourceMappingURL=ArraySchema.js.map