"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSecurity=getSecurity,exports.getSecurityScheme=getSecurityScheme,exports.getSecuritySchemes=getSecuritySchemes;const utils_1=require("../utils");function getSecurity(e=[],t){return e.map((e=>getSecurityRequirement({requirement:e,parser:t}))).filter((({schemes:e})=>e.length>0))}function getSecurityRequirement({requirement:e,parser:t}){const r=t.definition.components&&t.definition.components.securitySchemes||{};return{schemes:Object.keys(e||{}).map((i=>{const n=t.deref(r[i]).resolved,c=e[i]||[];if(n)return Object.assign(Object.assign({},n),{id:i,sectionId:i,scopes:c})})).filter(Boolean)}}function getSecurityScheme(e,t,r){if(!(null==e?void 0:e.deref))return{};const{resolved:i}=e.deref(r),n=t,c=i.type,s=(0,utils_1.getValueFromMdParsedExtension)(i,"description")||"";let o,u,a,m={};switch(i.type){case"apiKey":o={name:i.name,in:i.in};break;case"http":u={scheme:i.scheme,bearerFormat:i.bearerFormat};break;case"openIdConnect":a={connectUrl:i.openIdConnectUrl};break;case"oauth2":m=i.flows}return{id:t,sectionId:n,type:c,description:s,apiKey:o,http:u,flows:m,openId:a}}function getSecuritySchemes({parser:e}){var t,r;if(!e)return[];const i=(null===(r=null===(t=e.definition)||void 0===t?void 0:t.components)||void 0===r?void 0:r.securitySchemes)||{};return Object.keys(i).map((t=>getSecurityScheme(e,t,i[t])))}
//# sourceMappingURL=security.js.map