"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,a){void 0===a&&(a=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,a,r)}:function(e,t,i,a){void 0===a&&(a=i),e[a]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMediaType=getMediaType;const Sampler=__importStar(require("openapi-sampler")),schema_1=require("./schema"),utils_1=require("../utils"),example_1=require("./example");function generateExamples({parser:e,info:{encoding:t,schema:i},schema:a,mime:r,options:{isRequestType:n,onlyRequiredInSamples:s,generatedSamplesMaxDepth:o,format:l="json"}}){const p={skipReadOnly:n,skipWriteOnly:!n,skipNonRequired:n&&s,maxSampleDepth:o,quiet:!0,format:l};let m={};if(a&&a.oneOf)for(const i of a.oneOf){const n=Sampler.sample(i.rawSchema,p,e.definition);a.discriminatorProp&&"object"==typeof n&&n&&n[a.discriminatorProp]&&(n[a.discriminatorProp]=i.title),m[i.title]=(0,example_1.getExamples)({parser:e,infoOrRef:{value:n},mime:r,encoding:t})}else m=a?{default:(0,example_1.getExamples)({parser:e,infoOrRef:{value:Sampler.sample(i,p,e.definition)},mime:r,encoding:t})}:{default:{value:null,rawValue:"null"}};return m}function getMediaType(e,t,i,a,r,{operation:n,type:s,response:o,absolutePointer:l=""}){let p,m;const u=a.schema&&(0,schema_1.getSchema)({parser:e,schemaOrRef:a.schema,pointer:"",absolutePointer:utils_1.JsonPointer.join(l,["content",t,"schema"]),options:r,deps:{operation:n,type:s,response:o}}),{onlyRequiredInSamples:c,generatedSamplesMaxDepth:d}=r,{encoding:f,examples:_,example:g}=a;return r.unstable_skipSamples||(void 0!==_?p=(0,utils_1.mapValues)(_,(i=>(0,example_1.getExamples)({parser:e,infoOrRef:i,mime:t,encoding:f}))):void 0!==g?p={default:(0,example_1.getExamples)({parser:e,infoOrRef:{value:e.deref(g).resolved},mime:t,encoding:f})}:(0,utils_1.isJsonLike)(t)||(0,utils_1.isXmlLike)(t)?p=generateExamples({parser:e,info:a,schema:u,mime:t,options:{isRequestType:i,onlyRequiredInSamples:c,generatedSamplesMaxDepth:d,format:(0,utils_1.isXmlLike)(t)?"xml":"json"}}):((0,utils_1.isFormUrlEncoded)(t)||(0,utils_1.isMultipartFormData)(t))&&(m=generateExamples({parser:e,info:a,schema:u,mime:t,options:{isRequestType:i,onlyRequiredInSamples:c,generatedSamplesMaxDepth:d}}))),{examples:p,schema:u,name:t,isRequestType:i,formExamples:m,onlyRequiredInSamples:c,operation:n}}
//# sourceMappingURL=mediaType.js.map