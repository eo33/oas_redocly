"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addMarkdownItems=addMarkdownItems;const markdoc_1=require("@markdoc/markdoc"),theme_1=require("@redocly/theme"),models_1=require("../../models"),utils_1=require("../../utils");function addMarkdownItems(e,t,i){const n=(0,theme_1.isString)(e)?(0,markdoc_1.parse)(e):markdoc_1.Ast.fromJSON(JSON.stringify(null==e?void 0:e.result)),r=[];let o;const s=(e,t,i=r,n,o)=>{let s;e=(0,utils_1.unescapeHTMLChars)(e),n.attributes.id?s=n.attributes.id:(s=o?`${o}/${(0,utils_1.safeSlugify)(e)}`:`section/${(0,utils_1.safeSlugify)(e)}`,n.attributes.id=s);const l={id:s.toLowerCase(),name:e,level:t,items:[],ast:[n]};return i.push(l),l},l=(e,t)=>{var i,n;null===(n=null===(i=e[e.length-1])||void 0===i?void 0:i.ast)||void 0===n||n.push(t)},d=e=>{var t;for(const i of e.children){const e=getMarkdownContent(i)||"";"heading"===i.type&&1===i.attributes.level?o=s(e,i.attributes.level,void 0,i):i.attributes.level?s(e,i.attributes.level,null==o?void 0:o.items,i,null==o?void 0:o.id):(null===(t=null==o?void 0:o.items)||void 0===t?void 0:t.length)?l(null==o?void 0:o.items,i):(null==r?void 0:r.length)&&l(r,i)}};if(Array.isArray(n))for(const e of n)d(e);else d(n);return mapHeadingsDeep(t,r,i)}function mapHeadingsDeep(e,t,i=1){return t.map((t=>{const n=(0,models_1.getTagOrGroup)("section",t,e);return n.depth=i,t.items&&(n.items=mapHeadingsDeep(n,t.items,i+1)),n}))}function getMarkdownContent(e){var t,i;return"string"==typeof(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t.content)?null===(i=e.attributes)||void 0===i?void 0:i.content:(null==e?void 0:e.children)?getMarkdownContent(e.children[0]):void 0}
//# sourceMappingURL=markdown.js.map