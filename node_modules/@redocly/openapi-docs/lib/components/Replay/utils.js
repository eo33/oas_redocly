"use strict";var __rest=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};Object.defineProperty(exports,"__esModule",{value:!0}),exports.convertOperationToReplayValue=convertOperationToReplayValue,exports.convertRequestSecurity=convertRequestSecurity;const theme_1=require("@redocly/theme");function convertOperationToReplayValue(e,t,n,a){var r,i;const o=(null==a?void 0:a.activeMimeName)||"application/json";return{name:e.name,method:e.httpVerb,parameters:convertParameters(e.parameters,null==n?void 0:n.requestValues),body:convertRequestBody(e.requestBody,t,(null===(r=null==n?void 0:n.requestValues)||void 0===r?void 0:r.body)?{activeExampleName:null==n?void 0:n.activeExampleName,[o]:null===(i=null==n?void 0:n.requestValues)||void 0===i?void 0:i.body}:{activeExampleName:null==n?void 0:n.activeExampleName}),path:e.path,servers:e.servers,security:convertRequestSecurity(e.security)}}function convertParameters(e,t){const n=new Set,a=e.map((e=>{var a;return n.add(e.in+":"+e.name),{name:e.name,in:e.in,required:e.required,description:e.description,example:(null===(a=null==t?void 0:t[String(e.in)])||void 0===a?void 0:a[e.name])||e.example,schema:e.schema}}));for(const[e,r]of Object.entries(t||{}))for(const[t,i]of Object.entries(r||{}))n.has(e+":"+t)||a.push({name:t,in:e,required:!1,description:"",example:String(i),schema:void 0});return a}function getInputType({type:e,format:t,enum:n}){return"string"!==e||"binary"!==t&&"base64"!==t?"object"===e?"multiline":n.length>0?"select":"text":"file"}function getFieldExamples(e,t){var n,a,r,i,o;const l=(null===(n=e[0])||void 0===n?void 0:n.example)||(null===(a=e[0])||void 0===a?void 0:a.examples);if(l)return l;if(null===(r=e.schema)||void 0===r?void 0:r.example)return e.schema.example;const m=(null===(i=null==t?void 0:t.default)||void 0===i?void 0:i.value)||(null===(o=null==t?void 0:t.default)||void 0===o?void 0:o.rawValue);return(null==m?void 0:m[e.name])?(0,theme_1.isPrimitive)(null==m?void 0:m[e.name])?String(null==m?void 0:m[e.name]):JSON.stringify(null==m?void 0:m[e.name]):""}function convertRequestBody(e,t,n){var a;if(!e||!(null===(a=e.content)||void 0===a?void 0:a.mediaTypes)){if(!n)return;const{activeExampleName:e}=n,t=__rest(n,["activeExampleName"]);return{activeExampleName:e,mediaTypes:Object.fromEntries(Object.entries(t).map((([e,t])=>[e,{name:e,examples:{default:{value:t}},schema:{},parameters:[]}])))}}return{required:e.required,activeExampleName:null==n?void 0:n.activeExampleName,mediaTypes:e.content.mediaTypes.reduce(((e,a)=>{var r,i;const o=a.schema,l=(null==n?void 0:n[a.name])?{default:{value:null==n?void 0:n[a.name],rawValue:null==n?void 0:n[a.name],mime:a.name}}:a.examples||a.formExamples;return e[a.name]={name:a.name,examples:l,schema:getBodySchema(null===(r=a.schema)||void 0===r?void 0:r.rawSchema,t),parameters:null===(i=null==o?void 0:o.fields)||void 0===i?void 0:i.map((e=>({inputType:getInputType(e.schema),name:e.name,example:getFieldExamples(e,l)})))},e}),{})}}function getBodySchema(e,t){if(e&&t)return Object.assign(Object.assign({},e),{components:(null==t?void 0:t.components)||{}})}function convertRequestSecurity(e){if(e)return e.map((({schemes:e})=>e.map((e=>({id:e.id,type:e.type,in:e.in,openIdConnectUrl:e.openIdConnectUrl,scopes:e.scopes,scheme:e.scheme,name:e.name,flows:e.flows})))))}
//# sourceMappingURL=utils.js.map