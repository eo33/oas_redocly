"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SchemaDefinition=void 0;const jsx_runtime_1=require("react/jsx-runtime"),react_1=require("react"),styled_components_1=__importDefault(require("styled-components")),theme_1=require("@redocly/theme"),jotai_1=require("jotai"),nexus_1=require("../../jotai/nexus"),common_1=require("../common"),models_1=require("../../models"),PayloadSamples_1=require("../PayloadSamples"),Schema_1=require("../Schema"),Markdown_1=require("../Markdown"),app_1=require("../../jotai/app"),store_1=require("../../jotai/store"),operation_1=require("../../jotai/operation"),getMediaTypeInfo=(e,o)=>{if(!e)return{};const i={schema:{$ref:e}};return o&&(i.examples={example:{$ref:o}}),i};function SchemaDefinitionComponent({schemaRef:e,exampleRef:o,showReadOnly:i=!0,showWriteOnly:t=!1}){var a,n,r;const s=(0,jotai_1.useAtomValue)(app_1.layoutAtom),{parser:m,options:l}=(0,jotai_1.useAtomValue)(store_1.globalStoreAtom),c=(0,react_1.useMemo)((()=>(0,models_1.getMediaType)(m,"json",!1,getMediaTypeInfo(e,o),l,{operation:{pointer:"SchemaDefinitionComponent"}})),[o,l,m,e]),[_,p]=(0,jotai_1.useAtom)((0,operation_1.operationStore)(null===(a=c.operation)||void 0===a?void 0:a.pointer)),u=(0,react_1.useCallback)((e=>{if(!c.schema)return;const o=c.schema,i=o.oneOf;if(i&&(null==c?void 0:c.examples)&&Object.keys(null==c?void 0:c.examples).includes(e)){const t=i.findIndex((o=>o.title===e));-1!==t&&o&&(0,nexus_1.writeAtom)((0,operation_1.operationStore)(o.operationPointer),(e=>{var i,a;return Object.assign(Object.assign({},e),{activeExampleName:(null===(a=null===(i=o.oneOf)||void 0===i?void 0:i[t])||void 0===a?void 0:a.title)||e.activeExampleName,activeOneOf:Object.assign(Object.assign({},e.activeOneOf),{[o.pointer]:t})})}))}_.activeExampleName!==e&&p((o=>Object.assign(Object.assign({},o),{activeExampleName:e})))}),[null==c?void 0:c.examples,c.schema,_.activeExampleName,p]),d=s===theme_1.LayoutVariant.STACKED;return(0,jsx_runtime_1.jsx)(common_1.Section,{children:(0,jsx_runtime_1.jsxs)(common_1.Row,{layout:s,children:[(0,jsx_runtime_1.jsxs)(common_1.SamplesMiddlePanel,{isStacked:d,children:[(null===(n=c.schema)||void 0===n?void 0:n.description)&&(0,jsx_runtime_1.jsx)(Description,{children:(0,jsx_runtime_1.jsx)(Markdown_1.Markdown,{source:null===(r=c.schema)||void 0===r?void 0:r.description})}),(0,jsx_runtime_1.jsx)(Schema_1.Schema,{skipWriteOnly:!t,skipReadOnly:!i,schema:c.schema,level:1})]}),(0,jsx_runtime_1.jsx)(common_1.SamplesPanel,{isStacked:d,children:(0,jsx_runtime_1.jsx)(common_1.CodeBlockPanel,{className:"panel-response-samples",children:(0,jsx_runtime_1.jsx)(PayloadSamples_1.MediaTypeSamples,{mediaType:c,onChange:u})})})]})})}exports.SchemaDefinition=(0,react_1.memo)(SchemaDefinitionComponent);const Description=styled_components_1.default.div`
  margin-bottom: var(--spacing-vertical);
`;
//# sourceMappingURL=SchemaDefinition.js.map